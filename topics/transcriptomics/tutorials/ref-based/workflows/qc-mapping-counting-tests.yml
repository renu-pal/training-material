---
- doc: "Test sample data for Transcriptomics:Refence-based PE"
  job:
    Paired list collection with PE fastqs:
      class: Collection
      collection_type: 'list:paired'
      elements:
        - class: Collection
          type: paired
          identifier: GSM461177
          elements:
          - identifier: forward
            class: File
            location: https://zenodo.org/record/6457007/files/GSM461177_1_subsampled.fastqsanger
            filetype: fastqsanger
          - identifier: reverse
            class: File
            location: https://zenodo.org/record/6457007/files/GSM461177_2_subsampled.fastqsanger
            filetype: fastqsanger
        - class: Collection
          type: paired
          identifier: GSM461180
          elements:
          - identifier: forward
            class: File
            location: https://zenodo.org/record/6457007/files/GSM461180_1_subsampled.fastqsanger
            filetype: fastqsanger
          - identifier: reverse
            class: File
            location: https://zenodo.org/record/6457007/files/GSM461180_2_subsampled.fastqsanger
            filetype: fastqsanger
    Drosophila_melanogaster.BDGP6.32.109_UCSC.gtf.gz:
      class: File
      location: https://zenodo.org/record/6457007/files/Drosophila_melanogaster.BDGP6.32.109_UCSC.gtf.gz
      decompress: true
      filetype: gtf
  outputs:
    multiqc_cutadapt_html:
      asserts:
        has_text:
          text: '<h3 id="cutadapt_filtered_reads">'
    multiqc_falco_html:
      asserts:
        - that: "has_text"
          text: 'All samples have sequences of a single length (37bp)'
        - that: "has_text"
          text: '"GSM461180_forward": "pass"'
        - that: "has_text"
          text: '"GSM461177_reverse": "pass"'
        - that: "has_text"
          text: '"GSM461180_reverse": "pass"'
        - that: "has_text"
          text: '"GSM461177_forward": "pass"'
    pgt:
      asserts:
        has_size:
          value: 43294
          delta: 4000
    multiqc_featureCounts_html:
      asserts:
        has_text:
          text: '<h3 id="featurecounts_assignments">'
    multiqc_reads_per_chrom_html:
      asserts:
        has_text:
          text: '<h3 id="samtools-idxstats-xy-counts">'
    multiqc_dup_html:
      asserts:
        has_text:
          text: '<h3 id="picard-markduplicates">'
    multiqc_gene_body_cov_html:
      asserts:
        has_text:
          text: '<h3 id="rseqc-gene_body_coverage">'
    Gene length:
      asserts:
        has_n_lines:
          n: 23932
        has_line:
          line: "FBgn0000003\t299"
    multiqc_star_html:
      asserts:
        has_text:
          text: '<h3 id="star_summary">'
    multiqc_star_counts_html:
      asserts:
        has_text:
          text: '<h3 id="star_geneCounts">'
    multiqc_read_distrib_html:
      asserts:
        has_text:
          text: '<h3 id="rseqc-read_distribution">'
    STAR_BAM:
      element_tests:
        GSM461177:
          asserts:
            has_size:
              value: 77189682
              delta: 7000000
        GSM461180:
          asserts:
            has_size:
              value: 93798515
              delta: 9000000
    featureCounts_sorted:
      element_tests:
        GSM461177:
          asserts:
            has_text:
              text: "FBgn0284245\t12871"
        GSM461180:
          asserts:
            has_text:
              text: "FBgn0284245\t12904"
    featureCounts:
      element_tests:
        GSM461177:
          asserts:
            has_text:
              text: "FBgn0250732\t74"
        GSM461180:
          asserts:
            has_text:
              text: "FBgn0250732\t75"
    featureCounts_gene_length:
      element_tests:
        GSM461177:
          asserts:
            has_n_lines:
              n: 23933
            has_line:
              line: "FBgn0000003\t299"
        GSM461180:
          asserts:
            has_n_lines:
              n: 23933
            has_line:
              line: "FBgn0000003\t299"
    inferexperiment:
      element_tests:
        GSM461177:
          asserts:
            has_text:
              text: 'Fraction of reads explained by "1++,1--,2+-,2-+": 0.4967'
        GSM461180:
          asserts:
            has_text:
              text: 'Fraction of reads explained by "1++,1--,2+-,2-+": 0.4855'
    counts_from_star:
      element_tests:
        GSM461177:
          asserts:
            has_text:
              text: "FBgn0250732\t74"
        GSM461180:
          asserts:
            has_text:
              text: "FBgn0250732\t75"
    counts_from_star_sorted:
      element_tests:
        GSM461177:
          asserts:
            has_text:
              text: "FBgn0284245\t12869"
        GSM461180:
          asserts:
            has_text:
              text: "FBgn0284245\t12902"
